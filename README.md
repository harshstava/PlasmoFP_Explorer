# 🧬 PlasmoFP Explorer

A comprehensive Streamlit web application for exploring PlasmoFP gene predictions and annotations across 19 Plasmodium species.

## ✨ Features

### Basic Version (`plasmoFP_explorer.py`)
- **Gene Search**: Search by gene ID with autocomplete
- **Species Overview**: Summary statistics and visualizations  
- **Interactive Interface**: Clean, intuitive web interface
- **Original vs PFP Annotations**: Compare existing and predicted annotations
- **Multiple FDR Thresholds**: View predictions at different confidence levels

### Enhanced Version (`plasmoFP_explorer_enhanced.py`)
- **Advanced Gene Search** with filtering options
- **Batch Gene Search** for comparing multiple genes
- **Interactive Visualizations** with Plotly charts
- **Enhanced Statistics** with correlation analysis
- **Species Similarity Analysis** based on gene patterns
- **FDR Threshold Analysis** for prediction quality assessment
- **Mobile-Responsive Design** for all devices
- **Advanced Caching** for improved performance

## 🚀 Quick Start

### Prerequisites
- Python 3.8+
- Virtual environment (recommended)

### Installation

1. **Clone or navigate to the project directory:**
   ```bash
   cd "/Users/harsh/Documents/plasmofp website"
   ```

2. **Activate the virtual environment:**
   ```bash
   source .venv/bin/activate
   ```

3. **Install dependencies:**
   ```bash
   pip install -r requirements.txt
   ```

### Running the Application

#### Basic Version
```bash
streamlit run plasmoFP_explorer.py
```

#### Enhanced Version (Recommended)
```bash
streamlit run plasmoFP_explorer_enhanced.py
```

The application will open in your browser at `http://localhost:8501`

## 📊 Data Structure

The application reads PlasmoFP dictionaries from `with_PFP_predictions_complete_2/` containing:

- **19 Plasmodium species** gene dictionaries
- **PFP predictions** at 5 FDR thresholds (0.01, 0.05, 0.10, 0.20, 0.30)
- **Original GO annotations** (experimental + IEA)
- **Protein embeddings** for ML predictions
- **Gene ontology aspects**: Molecular Function (MF), Biological Process (BP), Cellular Component (CC)

## 🔍 How to Use

### 1. Gene Search
- Enter a gene ID (e.g., `PF3D7_0001`, `PVX_0001`)
- Use partial matches (e.g., `PF3D7` to find all P. falciparum genes)
- Filter by species, PFP availability, or existing annotations
- View detailed results in expandable sections

### 2. Batch Search (Enhanced)
- Search multiple genes simultaneously
- Compare annotations side-by-side
- Visualize relationships between genes
- Export comparison data

### 3. Species Overview
- View coverage statistics across all species
- Interactive charts showing gene counts and coverage
- Filter by minimum gene counts or coverage percentages
- Correlation analysis between different metrics

### 4. Advanced Analytics (Enhanced)
- **FDR Analysis**: Understand prediction quality across thresholds
- **Species Similarity**: Heatmap of species relationships
- **Coverage Statistics**: Comprehensive annotation coverage analysis

## 📁 File Structure

```
plasmofp website/
├── plasmoFP_explorer.py              # Basic Streamlit application
├── plasmoFP_explorer_enhanced.py     # Enhanced version with advanced features
├── advanced_features.py              # Advanced functionality modules
├── requirements.txt                  # Python dependencies
├── README.md                         # This file
├── .venv/                            # Virtual environment
└── with_PFP_predictions_complete_2/  # PlasmoFP data directory
    ├── PlasmoDB-68_Pfalciparum3D7_gene_dict_with_PFP.pkl
    ├── PlasmoDB-68_PvivaxSal1_gene_dict_with_PFP.pkl
    └── ... (17 more species files)
```

## 🎯 Key Features Explained

### PFP Predictions
- **Machine Learning**: Predictions generated by PlasmoFP neural networks
- **Quality Control**: Multiple FDR thresholds for confidence levels
- **Comprehensive**: Covers all three GO aspects (MF, BP, CC)
- **Validated**: Only deepest, non-redundant terms included

### Gene Search
- **Fast**: Optimized search across 100,000+ genes
- **Flexible**: Partial matching and filtering options
- **Comprehensive**: Shows both existing and predicted annotations
- **Visual**: Interactive charts and comparisons

### Analytics
- **Statistical**: Correlation analysis and trend identification
- **Comparative**: Species-to-species comparisons
- **Visual**: Interactive plots and heatmaps
- **Exportable**: Download data for further analysis

## 🧬 Supported Species

The application includes data for 19 Plasmodium species:

- **P. falciparum** (3D7) - Human malaria parasite
- **P. vivax** (Sal1) - Human malaria parasite  
- **P. berghei** (ANKA) - Rodent model
- **P. yoelii** (17XNL) - Rodent model
- **P. knowlesi** (H) - Zoonotic malaria
- And 14 additional species...

## 💡 Tips for Best Experience

1. **Start with Enhanced Version**: More features and better performance
2. **Use Filters**: Narrow down searches with species/annotation filters  
3. **Explore Batch Search**: Compare related genes simultaneously
4. **Check Multiple FDR Levels**: Balance sensitivity vs specificity
5. **Use Species Overview**: Understand data coverage before detailed searches

## 🛠️ Technical Details

### Performance Optimizations
- **Streamlit Caching**: Intelligent data caching for faster loads
- **Lazy Loading**: Progressive data loading with progress indicators
- **Memory Efficient**: Optimized data structures for large datasets
- **Responsive UI**: Works on desktop, tablet, and mobile devices

### Data Processing
- **Pickle Format**: Efficient serialization of complex data structures
- **Numpy Arrays**: Fast numerical operations for embeddings
- **Pandas Integration**: Structured data analysis and visualization
- **Plotly Visualizations**: Interactive, publication-ready charts

## 🚨 Troubleshooting

### Common Issues

1. **"Directory not found" error**
   - Ensure `with_PFP_predictions_complete_2/` directory exists
   - Check that pickle files are present

2. **Slow loading**
   - First load takes time due to large data files
   - Subsequent loads are cached and faster

3. **Memory issues**
   - Close other applications if running out of memory
   - Use basic version for lower memory usage

4. **Import errors**
   - Ensure virtual environment is activated
   - Reinstall requirements: `pip install -r requirements.txt`

### Performance Tips
- Use smaller search limits for faster results
- Filter by species to reduce data loading
- Close browser tabs when not in use
- Restart app if memory usage becomes high

## 📈 Future Enhancements

Potential improvements and additions:
- **Export functionality** for search results
- **Gene set analysis** tools
- **Pathway enrichment** analysis
- **Protein structure** integration
- **Literature links** for genes and functions
- **API endpoints** for programmatic access

## 📞 Support

For questions, issues, or feature requests:
- Check the troubleshooting section above
- Review the application's built-in help text
- Contact the development team

## 🎉 Acknowledgments

- **PlasmoFP Team**: For the machine learning predictions
- **PlasmoDB**: For the underlying gene annotations
- **Streamlit Community**: For the excellent web framework
- **Plotly**: For interactive visualization capabilities

---

**Happy exploring! 🧬🔬**


